---
id: cf-380C
source: CF
title: Sereja and Brackets
author: Sultan Alaiban
---

In the segment tree, will store three values: the number of unused `(`'s, the number of unused `)`'s, and the longest bracket subsequence. Let's call these value $O$, $C$, and $S$. respectively. Then they would be combined like this:

$S = left.S + right.S + 2 \cdot min(left.O, right.C)$
$O = left.O + right.O - min(left.O, right.C)$
$C = left.C + right.C - min(left.O, rigth.C)$
